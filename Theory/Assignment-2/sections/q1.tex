\section*{Problem 1}

Compute the mathematical expression for the solution of the following system:
\begin{equation*}
    \dot x(t)
    =
    \begin{bmatrix}
        \frac{-t}{1+t^2} & 1                 \\
        0                & \frac{-4t}{1+t^2}
    \end{bmatrix}
    x(t)
\end{equation*}
Assume initial condition \( x(0) = x_0 \).
What happens if \( t \rightarrow \infty \)?
Explain your answer.

\subsection*{Solution}

Given the homogeneous linear time-varying system:
\begin{equation*}
    \dot{x}(t)
    =
    A(t) x(t),
    \quad
    A(t)
    =
    \begin{bmatrix}
        \frac{-t}{1+t^2} & 1                 \\
        0                & \frac{-4t}{1+t^2}
    \end{bmatrix},
    \quad
    x(0) = x_0
\end{equation*}
Define \( M(t) \) as follows:
\begin{equation*}
    M(t)
    \triangleq
    \int_{0}^{t} A(l) \, dl
\end{equation*}

\begin{align*}
    \implies
    M(t)
     & =
    \int_{0}^{t}
    \begin{bmatrix}
        \frac{-l}{1+l^2} & 1                 \\
        0                & \frac{-4l}{1+l^2}
    \end{bmatrix}
    \, dl
    =
    \begin{bmatrix}
        \int_{0}^{t} \frac{-l}{1+l^2} \, dl
         &
        \int_{0}^{t} 1 \, dl
        \\
        0
         &
        \int_{0}^{t} \frac{-4l}{1+l^2} \, dl
    \end{bmatrix}
    \\ & =
    \begin{bmatrix}
        -\frac{1}{2} \ln(1+t^2)
         &
        t
        \\
        0
         &
        -2 \ln(1+t^2)
    \end{bmatrix}
\end{align*}

We check for the commutativity of \( M(t) \) and \( A(t) \) as follows
\begin{align*}
    \implies
    M(t) A(t)
     & =
    \begin{bmatrix}
        \frac{t \ln(1+t^2)}{2(1+t^2)} & -\frac{1}{2} \ln(1+t^2) - \frac{4t^2}{1+t^2} \\
        0                             & \frac{8t \ln(1+t^2)}{1+t^2}
    \end{bmatrix}
    \\
    \implies
    A(t) M(t)
     & =
    \begin{bmatrix}
        \frac{t \ln(1+t^2)}{2(1+t^2)} & -\frac{t^2}{1+t^2} - 2 \ln(1+t^2) \\
        0                             & \frac{8t \ln(1+t^2)}{1+t^2}
    \end{bmatrix}
\end{align*}

We find that \( M(t) \) and \( A(t) \) do not commute.

\clearpage
Now, let \( x(t) = {[x_1(t), x_2(t)]}^T \).
We have the following set of equations
\begin{align*}
    \dot{x}_1(t)
     & =
    \frac{-t}{1+t^2} x_1(t) + x_2(t)
    \\
    \dot{x}_2(t)
     & =
    \frac{-4t}{1+t^2} x_2(t)
\end{align*}

We can observe that since \( A(t) \) is upper triangular, we have the system of equations decoupled and the second equation can be solved for \( x_2(t) \) independently.

\begin{align*}
    \frac{d x_2(t)}{dt}
     & =
    \frac{-4t}{1+t^2} x_2(t)
    \implies
    \frac{d x_2(t)}{x_2(t)}
    =
    \frac{-4t}{1+t^2} dt
    \implies
    \int \frac{d x_2(t)}{x_2(t)}
    =
    \int \frac{-4t}{1+t^2} dt
    \\
    \implies
    \ln \lvert x_2(t) \rvert
     & =
    -2 \ln(1+t^2) + C
    \implies
    x_2(t)
    =
    \frac{C}{{(1+t^2)}^2}
\end{align*}
where we can see that \( C = x_2(0) \).

Substituting \( x_2(t) \) back into the first equation to solve for \( x_1(t) \), we get
\begin{align*}
    \frac{d x_1(t)}{dt}
     & =
    \frac{-t}{1+t^2} x_1(t) + \frac{C}{{(1+t^2)}^2}
    \implies
    \frac{d x_1(t)}{dt}
    +
    P(t) x_1(t)
    =
    Q(t)
\end{align*}
which is a first-order linear ordinary differential equation, that can be solved using the integrating factor method.
The integrating factor is
\begin{align*}
    \mu(t)
     & =
    e^{\int P(t) \, dt}
    =
    e^{\int \frac{t}{1+t^2} \, dt}
    =
    e^{\frac{1}{2} \ln(1+t^2)}
        =
        {(1+t^2)}^{\frac{1}{2}}
    \\
    \implies
    \mu(t) \frac{d x_1(t)}{dt}
     & +
    \mu(t) P(t) x_1(t)
    =
    \mu(t) Q(t)
    \implies
    \frac{d}{dt} \left( \mu(t) x_1(t) \right)
    =
    \mu(t) Q(t)
    \\
    \implies
    \mu(t) x_1(t)
     & =
    \int \mu(t) Q(t) \, dt
    =
    \int \frac{C}{{(1+t^2)}^2} \cdot {(1+t^2)}^{\frac{1}{2}} \, dt
    =
    C \int \frac{1}{{(1+t^2)}^{\frac{3}{2}}} \, dt
\end{align*}
Putting \( t = \tan \theta \), we have \( dt = \sec^2 \theta \, d\theta \), and
\begin{align*}
    \mu(t) x_1(t)
     & =
    C \int \frac{1}{{(1+\tan^2 \theta)}^{\frac{3}{2}}} \sec^2 \theta \, d\theta
    =
    C \int \frac{1}{{\sec^2 \theta}^{\frac{3}{2}}} \sec^2 \theta \, d\theta
    \\ & =
    C \int \cos \theta \, d\theta
    =
    C \sin \theta + D
    =
    C \frac{t}{\sqrt{1+t^2}} + D
    \\
    \implies
    x_1(t)
     & =
    \frac{C t}{\mu(t) \sqrt{1+t^2}} + \frac{D}{\mu(t)}
    =
    \frac{C t}{(1+t^2)} + \frac{D}{\sqrt{1+t^2}}
    =
    \frac{x_2(0) t}{(1+t^2)} + \frac{x_1(0)}{\sqrt{1+t^2}}
\end{align*}

Thereby, the solution is given by
\begin{equation*}
    \boxed{
        x(t)
        =
        \begin{bmatrix}
            \frac{1}{\sqrt{1+t^2}}
             & \frac{t}{(1+t^2)}
            \\
            0
             & \frac{1}{{(1+t^2)}^2}
        \end{bmatrix}
        x_0
    }
\end{equation*}

As \( t \rightarrow \infty \), the solution converges to
\begin{equation*}
    \lim_{{t \to \infty}} x(t)
    =
    \begin{bmatrix}
        0 & 0 \\
        0 & 0
    \end{bmatrix}
    x_0
    =
    \begin{bmatrix}
        0 \\
        0
    \end{bmatrix}
\end{equation*}
i,e., the \underline{states decay towards the origin as \( t \rightarrow \infty \)}.

\clearpage
\subsection*{(Initial) Solution}

\textbf{Note}: Initially, it was assumed that the matrices \( M(t) \) and \( A(t) \) commute.
This turns out to be incorrect.
Below is the original solution based on this assumption, that is included here for the sake of demonstration.

\vspace*{3em}
Provided \( M(t) \) and \( A(t) \) commute
(this doesn't hold), we have the state transition matrix
\begin{align*}
    \Phi(t, 0)
     & =
    e^{M(t)} x_0
    \\
    \implies
    e^{M(t)}
     & =
    I + M(t) + \frac{1}{2!} M^2(t) + \frac{1}{3!} M^3(t) + \ldots
\end{align*}
Computing the first few powers of the matrix \( M(t) \), we have
\begin{align*}
    \implies
    M(t)
     & =
    \begin{bmatrix}
        -\frac{1}{2} \ln(1+t^2)
         &
        t
        \\
        0
         &
        -2 \ln(1+t^2)
    \end{bmatrix}
    \\
    \implies
    M^2(t)
     & =
    M(t) \, M(t)
    =
    \begin{bmatrix}
        \frac{1}{4} \ln^2(1+t^2)
         &  &
        -\frac{5}{2} t \ln(1+t^2)
        \\ \\
        0
         &  &
        4 \ln^2(1+t^2)
    \end{bmatrix}
\end{align*}
\begin{align*}
    \implies
    M^3(t)
     & =
    M(t) \, M^2(t)
    =
    \begin{bmatrix}
        -\frac{1}{8} \ln^3(1+t^2)
         &  &
        \frac{21}{4} t \ln^2(1+t^2)
        \\ \\
        0
         &  &
        -8 \ln^3(1+t^2)
    \end{bmatrix}
    \\
    \implies
    M^4(t)
     & =
    M(t) \, M^3(t)
    =
    \begin{bmatrix}
        \frac{1}{16} \ln^4(1+t^2)
         &  &
        -\frac{85}{8} t \ln^3(1+t^2)
        \\ \\
        0
         &  &
        16 \ln^4(1+t^2)
    \end{bmatrix}
\end{align*}

By inspection, we can see that \( M^{k} (t) \) for \( k = 1, 2, 3, \ldots \) is given by,
\begin{equation*}
    M^{k} (t)
    =
    \begin{bmatrix}
        \displaystyle
        {(-1)}^{k} \frac{1}{2^k} \ln^{k}(1+t^2)
         &  &  &
        \displaystyle
        {(-1)}^{k-1} \left( \frac{4^k-1}{3} \right) \frac{1}{2^{k-1}} t \ln^{k-1}(1+t^2)
        \\ \\
        0
         &  &  &
        \displaystyle
        {(-1)}^{k} 2^{k} \ln^{k}(1+t^2)
    \end{bmatrix}
\end{equation*}

\clearpage
Now, we can compute \( e^{M(t)} \) as follows.
Let
\begin{equation*}
    e^{M(t)}
    =
    \begin{bmatrix}
        a(t) & b(t) \\
        0    & c(t)
    \end{bmatrix}
\end{equation*}
where we have the elements of the matrix as
\begin{align*}
    a(t)
     & =
    1 + \sum_{k=1}^{\infty} \frac{1}{k!} {(-1)}^{k} \frac{1}{2^k} \ln^{k}(1+t^2)
    =
    \sum_{k=0}^{\infty} \frac{1}{k!} {\left( \frac{-1}{2} \ln(1+t^2) \right)}^{k}
    =
    e^{\frac{-1}{2} \ln(1+t^2)}
        =
        {(1+t^2)}^{\frac{-1}{2}}
    \\
    c(t)
     & =
    1 + \sum_{k=1}^{\infty} \frac{1}{k!} {(-1)}^{k} 2^{k} \ln^{k}(1+t^2)
    =
    \sum_{k=0}^{\infty} \frac{1}{k!} {(-2 \ln(1+t^2))}^{k}
    =
    e^{-2 \ln(1+t^2)}
        =
        {(1+t^2)}^{-2}
    \\
    b(t)
     & =
    \sum_{k=1}^{\infty} \frac{1}{k!} {(-1)}^{k-1} \left( \frac{4^k-1}{3} \right) \frac{1}{2^{k-1}} t \ln^{k-1}(1+t^2)
    \\ & =
    \frac{-2t}{3\ln(1+t^2)} \sum_{k=1}^{\infty} \frac{1}{k!} {\left( \frac{1}{2} \ln(1+t^2) \right)}^{k} (4^k - 1)
    \\ & =
    \frac{-2t}{3\ln(1+t^2)} \left(
    \sum_{k=1}^{\infty} \frac{1}{k!} {\left( \frac{1}{2} \ln(1+t^2) \right)}^{k} 4^k
    -
    \sum_{k=1}^{\infty} \frac{1}{k!} {\left( \frac{1}{2} \ln(1+t^2) \right)}^{k}
    \right)
    \\ & =
    \frac{-2t}{3\ln(1+t^2)} \left(
    e^{2 \ln(1+t^2)}
    -
    e^{\frac{1}{2} \ln(1+t^2)}
    \right)
    \\ & =
    \frac{-2t}{3\ln(1+t^2)} \left(
    {(1+t^2)}^{2}
    -
    {(1+t^2)}^{\frac{1}{2}}
    \right)
\end{align*}

Thereby, the state transition matrix is given by
\begin{equation*}
    \Phi(t, 0)
    =
    \begin{bmatrix}
        {(1+t^2)}^{\frac{-1}{2}}
         &  &
        \frac{-2t}{3\ln(1+t^2)} \left( {(1+t^2)}^{2} - {(1+t^2)}^{\frac{1}{2}} \right)
        \\
        0
         &  &
        {(1+t^2)}^{-2}
    \end{bmatrix}
\end{equation*}
and the solution is given by
\begin{equation*}
    \phi(t)
    =
    \Phi(t, 0) x_0
    =
    \begin{bmatrix}
        {(1+t^2)}^{\frac{-1}{2}}
         &  &
        \frac{-2t}{3\ln(1+t^2)} \left( {(1+t^2)}^{2} - {(1+t^2)}^{\frac{1}{2}} \right)
        \\
        0
         &  &
        {(1+t^2)}^{-2}
    \end{bmatrix}
    x_0
\end{equation*}
