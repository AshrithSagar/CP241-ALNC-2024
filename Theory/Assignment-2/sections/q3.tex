\section*{Problem 3}

Consider the following system matrix:
\begin{equation*}
    A
    =
    \begin{bmatrix}
        -1 & \sin(t) \\
        0  & -1
    \end{bmatrix}
\end{equation*}
\begin{enumerate}[label= (\alph*)]
    \item Compute \( \Phi(t, 0) \) for \( A(t) \).
    \item Compute \( \Phi(t, \tau) \) for \( A(t) \) with initial time as \( \tau \), using the properties of STM on \( \Phi(t, 0) \) from part (a).
\end{enumerate}

\subsection*{Solution}

Given the homogeneous linear time-varying system:
\begin{equation*}
    \dot{x}(t) = A(t) x(t),
    \quad
    A(t)
    =
    \begin{bmatrix}
        -1 & \sin(t) \\
        0  & -1
    \end{bmatrix},
    \quad
    x(0) = x_0
\end{equation*}

\subsubsection*{(a) Computing \( \Phi(t, 0) \)}

Define \( M(t, \tau) \) as follows:
\begin{equation*}
    M(t, \tau)
    \triangleq
    \int_{\tau}^{t} A(l) \, dl
\end{equation*}
Provided \( M(t, \tau) \) and \( A(t) \) commute, we have the state transition matrix as
\begin{align*}
    \Phi(t, \tau)
     & =
    e^{M(t, \tau)} x_0
    \\
    \implies
    e^{M(t, \tau)}
     & =
    I + M(t, \tau) + \frac{1}{2!} M^2(t, \tau) + \frac{1}{3!} M^3(t, \tau) + \ldots
\end{align*}

Here \( \tau = 0 \).
Computing the first few powers of the matrix \( M(t, 0) \), we have
\begin{align*}
    M(t, 0)
     & =
    \int_{0}^{t} A(l) \, dl
    =
    \int_{0}^{t}
    \begin{bmatrix}
        -1 & \sin(l) \\
        0  & -1
    \end{bmatrix}
    \, dl
    =
    \begin{bmatrix}
        -t &  & 1 - \cos(t) \\
        0  &  & -t
    \end{bmatrix}
    \\
    M^2(t, 0)
     & =
    M(t, 0) \,
    M(t, 0)
    =
    \begin{bmatrix}
        t^2 &  & -2t(1 - \cos(t)) \\
        0   &  & t^2
    \end{bmatrix}
    \\
    M^3(t, 0)
     & =
    M(t, 0) \,
    M^2(t, 0)
    =
    \begin{bmatrix}
        -t^3 &  & 3t^2(1 - \cos(t)) \\
        0    &  & -t^3
    \end{bmatrix}
    \\
    M^4(t, 0)
     & =
    M(t, 0) \,
    M^3(t, 0)
    =
    \begin{bmatrix}
        t^4 &  & -4t^3(1 - \cos(t)) \\
        0   &  & t^4
    \end{bmatrix}
\end{align*}

By inspection, we find that \( M^{k} (t, 0) \) for \( k = 1, 2, 3, \ldots \) is given by,
\begin{equation*}
    M^{k} (t, 0)
    =
    \begin{bmatrix}
        {(-1)}^{k} t^{k}
         &  &
        {(-1)}^{k-1} k t^{k-1} (1 - \cos(t))
        \\
        0
         &  &
        {(-1)}^{k} t^{k}
    \end{bmatrix}
\end{equation*}
\begin{align*}
    \implies
    e^{M(t, 0)}
     & =
    I + \sum_{k=1}^{\infty} \frac{1}{k!} M^{k} (t, 0)
    \\ & =
    \begin{bmatrix}
        \displaystyle
        1 + \sum_{k=1}^{\infty} \cfrac{1}{k!} {(-1)}^{k} t^{k}
         &  &  &
        \displaystyle
        \sum_{k=1}^{\infty} \frac{1}{k!} {(-1)}^{k-1} k t^{k-1} (1 - \cos(t))
        \\
        0
         &  &  &
        \displaystyle
        1 + \sum_{k=1}^{\infty} \cfrac{1}{k!} {(-1)}^{k} t^{k}
    \end{bmatrix}
    \\ & =
    \begin{bmatrix}
        \displaystyle
        \sum_{k=0}^{\infty} \cfrac{{(-t)}^{k}}{k!}
         &  &  &
        \displaystyle
        (1 - \cos(t)) \sum_{k=1}^{\infty} \frac{{(-t)}^{k-1}}{(k-1)!}
        \\
        0
         &  &  &
        \displaystyle
        \sum_{k=0}^{\infty} \cfrac{{(-t)}^{k}}{k!}
    \end{bmatrix}
    \\ & =
    \begin{bmatrix}
        e^{-t}
         &  &
        (1 - \cos(t)) e^{-t}
        \\
        0
         &  &
        e^{-t}
    \end{bmatrix}
    =
    e^{-t}
    \begin{bmatrix}
        1
         &  &
        (1 - \cos(t))
        \\
        0
         &  &
        1
    \end{bmatrix}
\end{align*}
\begin{equation*}
    \implies
    \boxed{
        \Phi(t, 0)
        =
        x_0 e^{-t}
        \begin{bmatrix}
            1
             &  &
            (1 - \cos(t))
            \\
            0
             &  &
            1
        \end{bmatrix}
    }
\end{equation*}
