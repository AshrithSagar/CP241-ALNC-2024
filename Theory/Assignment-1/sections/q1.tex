\section*{Problem 1}

``Linear Systems Primer'' by Antsaklis and Michael;
Exercise 1.1(a)

\(M_1\) and \(M_2\) denote point masses; \(K_1, K_2, K\) denote spring constants; and \(x_1,x_2\) denote the displacements of the masses \(M_1\) and \(M_2\).
Use the Hamiltonian formulation of dynamical systems described above to derive a system of first-order ordinary differential equations that characterize this system.
Verify your answer by using Newton's second law of motion to derive the same system of equations.
Assume that \(x_1(0), \dot x_1(0), x_2(0)\), and \(\dot x_2(0)\) are given.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.7\textwidth]{figures/images/q1.png}
    \caption{
        Example of a conservative dynamical system
    }\label{fig:q1}
\end{figure}

\textit{Hint}: Use \(p\) and \(q\) as your state variables in both cases.
For derivation using Newton's law, mention the Free Body Diagram with all the forces and the direction taken as +ve direction.

\clearpage
\subsection*{Solution}

\subsubsection*{Hamiltonian formulation}

\begin{figure}[htb]
    \centering
    \includegraphics[page=1, width=0.8\linewidth]{figures/q1/_}
    \caption{
        Depiction of system for Hamiltonian formulation
    }\label{fig:q1-hamiltonian}
\end{figure}

Let \(x_1\) and \(x_2\) be the displacements of the masses \(M_1\) and \(M_2\) respectively, from their equilibrium positions in the system, as shown in Figure~\ref{fig:q1-hamiltonian}.
The given system contains no energy-dissipating elements, thereby it is a Conservative/Hamiltonian dynamical system.
Taking the state variables as \(p\) and \(q\), we have, with \(n=2\),
\[
    q = \begin{bmatrix} q_1 \\ q_2 \end{bmatrix} = \begin{bmatrix} x_1 \\ x_2 \end{bmatrix},
    \quad
    p = \begin{bmatrix} p_1 \\ p_2 \end{bmatrix} = \begin{bmatrix} M_1 \dot x_1 \\ M_2 \dot x_2 \end{bmatrix} = \begin{bmatrix} M_1 \dot q_1 \\ M_2 \dot q_2 \end{bmatrix}
\]

The Hamiltonian function \(H(p,q)\) is of the form
\[
    H(p,q) = T(q, \dot q) + W(q)
    \tag{1.1}
\]
where the function \(T(q, \dot q)\) is the kinetic energy of the system and \(W(q)\) is the potential energy of the system.
The kinetic energy of the system is given by
\[
    T(q, \dot q) = \int_{0}^{\dot q} {p(q, \xi)}^T \, d\xi
\]
The necessary and sufficient condition for this integral to be path-independent is
\[
    \frac{\partial p_i(q, \dot q)}{\partial \dot q_j} = \frac{\partial p_j(q, \dot q)}{\partial \dot q_i} \quad \forall i,j \in \{1,2\}
\]
which is verified as follows:
\begin{align*}
    \frac{\partial p_1(q, \dot q)}{\partial \dot q_2}
     & =
    \frac{\partial M_1 q_1}{\partial \dot q_2} = 0 \\
    \frac{\partial p_2(q, \dot q)}{\partial \dot q_1}
     & =
    \frac{\partial M_2 q_2}{\partial \dot q_1} = 0
\end{align*}
Thereby, we can write the kinetic energy of the system as follows:
\begin{align*}
    T(q, \dot q)
     & =
    \int_{0}^{\dot q} \sum_{i=1}^{n} p_i(q, \xi) \, d\xi_i
    \\ & =
    \int_{0}^{\dot q_1} M_1 \xi_1 \, d\xi_1
    + \int_{0}^{\dot q_2} M_2 \xi_2 \, d\xi_2
    \\ & =
    \frac{1}{2} M_1 {\dot q_1}^2
    + \frac{1}{2} M_2 {\dot q_2}^2
    \\ & =
    \frac{1}{2} \frac{p_1^2}{M_1}
    + \frac{1}{2} \frac{p_2^2}{M_2}
    \tag{1.2}
\end{align*}
Similarly, for the potential energy of the system, using Hooke's law, we have
\[
    W(q) = \int_{0}^{q} {f(\eta)}^T \, d\eta
    = \int_{0}^{q_1} (-K_1 \eta)\, d\eta
    + \int_{0}^{q_2 - q_1} (-K \eta)\, d\eta
    + \int_{0}^{q_2} (-K_2 \eta)\, d\eta
\]
\[
    \implies
    W(q) = \frac{1}{2} K_1 {q_1}^2 + \frac{1}{2} K {(q_2 - q_1)}^2 + \frac{1}{2} K_2 {q_2}^2
    \tag{1.3}
\]

Thereby, from Equations (1.1), (1.2) and (1.3), we have the Hamiltonian function as
\[
    H(p,q) =
    \frac{1}{2} \frac{p_1^2}{M_1}
    + \frac{1}{2} \frac{p_2^2}{M_2}
    + \frac{1}{2} K_1 {q_1}^2
    + \frac{1}{2} K {(q_2 - q_1)}^2
    + \frac{1}{2} K_2 {q_2}^2
    \tag{1.4}
\]

The Hamiltonian system is then given by the system of \(2n\) ordinary differential equation equations as follows:
\[
    \begin{aligned}
        \dot q_i & = \frac{\partial H}{\partial p_i}(p,q), \quad i = 1,2  \\
        \dot p_i & = -\frac{\partial H}{\partial q_i}(p,q), \quad i = 1,2
    \end{aligned}
    \tag{1.5}
\]
Thereby, we have for the given system as
\[
    \begin{aligned}
        \dot q_1 & = \frac{\partial H}{\partial p_1}(p,q) = \frac{\partial T}{\partial p_1} = \frac{1}{2}\frac{2 p_1}{M_1} = \frac{p_1}{M_1} \\
        \dot q_2 & = \frac{\partial H}{\partial p_2}(p,q) = \frac{\partial T}{\partial p_2} = \frac{1}{2}\frac{2 p_2}{M_2} = \frac{p_2}{M_2} \\
        \dot p_1 & = -\frac{\partial H}{\partial q_1}(p,q) = - \frac{\partial W}{\partial q_1} = -K_1 q_1 + K (q_2 - q_1)                    \\
        \dot p_2 & = -\frac{\partial H}{\partial q_2}(p,q) = - \frac{\partial W}{\partial q_2} = -K (q_2 - q_1) - K_2 q_2
    \end{aligned}
\]
Thereby, the state-space representation of the given system is as follows:
\[
    \boxed{
        \begin{bmatrix}
            \dot{q}_1 \\
            \dot{q}_2 \\
            \dot{p}_1 \\
            \dot{p}_2
        \end{bmatrix}
        =
        \begin{bmatrix}
            0          & 0          & 1/M_1 & 0     \\
            0          & 0          & 0     & 1/M_2 \\
            (-K_1 - K) & K          & 0     & 0     \\
            K          & (-K_2 - K) & 0     & 0
        \end{bmatrix}
        \begin{bmatrix}
            q_1 \\
            q_2 \\
            p_1 \\
            p_2
        \end{bmatrix}
    }
    \tag{1.6}
\]

\clearpage
\subsubsection*{Alternate formulation (Hamiltonian)}

The kinetic energy of the system is same as from previous, given by
\begin{equation*}
    T(q, \dot q)
    =
    \frac{1}{2} M_1 {\dot q_1}^2
    + \frac{1}{2} M_2 {\dot q_2}^2
    =
    \frac{1}{2} \frac{p_1^2}{M_1}
    + \frac{1}{2} \frac{p_2^2}{M_2}
\end{equation*}

The potential energy of the system is given by
\begin{equation*}
    W(q)
    =
    \int_{0}^{q} {f(\eta)}^T \, d\eta
\end{equation*}
The generalised forces \(f_1\) and \(f_2\) are given by
\begin{align*}
    f_1 & = -K_1 q_1 + K (q_2 - q_1) \\
    f_2 & = -K_2 q_2 - K (q_2 - q_1)
\end{align*}
\begin{align*}
    \implies
    - W(q)
     & =
    \int_{0}^{q_1} \Big( -K_1 \eta + K (q_2 - \eta) \Big)\, d\eta
    + \int_{0}^{q_2} \Big( -K_2 \eta - K (\eta - q_1) \Big)\, d\eta
    \\ & =
    \int_{0}^{q_1} (-K_1 - K)\eta \, d\eta
    + \int_{0}^{q_1} K q_2 \, d\eta
    + \int_{0}^{q_2} (-K_2 - K)\eta \, d\eta
    + \int_{0}^{q_2} K q_1 \, d\eta
    \\ & =
    (-K_1 - K) \frac{{q_1}^2}{2} + K q_2 q_1 + (-K_2 - K) \frac{{q_2}^2}{2} + K q_1 q_2
    \\ & =
    -\frac{1}{2} K_1 {q_1}^2 - \Big( \frac{1}{2} K {q_1}^2 - K q_1 q_2 + \frac{1}{2} K {q_2}^2 \Big) - \frac{1}{2} K_2 {q_2}^2
    \\ & =
    -\frac{1}{2} K_1 {q_1}^2 - \frac{1}{2} K {(q_2 - q_1)}^2 - \frac{1}{2} K_2 {q_2}^2
    \\
    \implies W(q)
     & =
    \frac{1}{2} K_1 {q_1}^2 + \frac{1}{2} K {(q_2 - q_1)}^2 + \frac{1}{2} K_2 {q_2}^2
\end{align*}

From here, we can continue with the Hamiltonian formulation as before.

\clearpage
\subsubsection*{Newtonian formulation}

\begin{figure}[htb]
    \centering
    \includegraphics[page=2, width=0.7\linewidth]{figures/q1/_}
    \caption{
        Free body diagram for Newtonian formulation
    }\label{fig:q1-newtonian}
\end{figure}

The spring forces are given by Hooke's law, which relates the force exerted by a spring to the displacement of the spring from its equilibrium position.
The free body diagrams of the masses \(M_1\) and \(M_2\) are given in the Figure~\ref{fig:q1-newtonian}, where the positive \(x\)-axis is taken towards the right.
Since the assumed displacement is towards the right, the spring force being restoring in nature will act towards the left, as seen in Figure~\ref{fig:q1-newtonian}.
From Newton's laws of motion, we can see that the acceleration of the masses are given by
\[
    \begin{aligned}
        M_1 \ddot x_1 & = K (x_2 - x_1) - K_1 x_1  \\
        M_2 \ddot x_2 & = -K_2 x_2 - K (x_2 - x_1)
    \end{aligned}
    \tag{1.7}
\]

Considering the state variables \(p\) and \(q\) as before, we have
\[
    q = \begin{bmatrix} q_1 \\ q_2 \end{bmatrix} = \begin{bmatrix} x_1 \\ x_2 \end{bmatrix},
    \quad
    p = \begin{bmatrix} p_1 \\ p_2 \end{bmatrix} = \begin{bmatrix} M_1 \dot x_1 \\ M_2 \dot x_2 \end{bmatrix} = \begin{bmatrix} M_1 \dot q_1 \\ M_2 \dot q_2 \end{bmatrix}
\]

Thereby, we can rewrite the equations (1.7) as
\[
    \begin{aligned}
        \dot q_1 & = \dot x_1 = \frac{p_1}{M_1} \\
        \dot q_2 & = \dot x_2 = \frac{p_2}{M_2} \\
        \dot p_1 & = K (q_2 - q_1) - K_1 q_1    \\
        \dot p_2 & = -K (q_2 - q_1) - K_2 q_2
    \end{aligned}
\]
which is the same system of equations as obtained using the Hamiltonian formulation in Equation~(1.6).
Thereby, the system is consistent with both the Hamiltonian and Newtonian formulations.
