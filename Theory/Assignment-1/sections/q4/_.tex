\section*{Problem 4}

The steel ball is suspended in the air by the electromagnet as shown in Figure~\ref{fig:q4}.
The objective is to keep the ball suspended at a particular equilibrium position by controlling the current \(i(t)\) applying proper input voltage \(v(t)\), where \(t \geq 0\) denotes time.
The resistance of the coil is \(R\) and the Inductance of the coil is given by \(L(s(t)) = \frac{L}{s(t)}\), with \(L\) is a constant and \(s(t)\) is the distance between the magnet and center of the ball at time t.
The force produced by the magnet is given by \(\frac{K i^2(t)}{s^2(t)}\), where \(K\) is a constant and \(g\) is the acceleration due to gravity.

\begin{enumerate}[label= (\alph*)]
    \item Determine the differential equations governing the dynamics of the system.
    \item Let \(v(t) = V_{in}\) is a nominal voltage. \\
          Find out the resulting equilibrium point of the system.
    \item Obtain the linearized system around the derived equilibrium point.
\end{enumerate}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.5\textwidth]{figures/images/q4.png}
    \caption{
        Magnetic Levitation System
    }\label{fig:q4}
\end{figure}

\subsection*{Solution}

\subsubsection*{(a) Governing differential equations}

Consider the upward direction to be the positive \(y\)-direction.
The underlying laws are the Newton's laws of motion and Kirchoff's voltage law.
With \(s(t)\) as the state variable, we have the differential equations governing the dynamics of the system as follows,
\begin{align*}
    M \ddot s(t) & = \frac{Ki^2(t)}{s^2(t)} - Mg             \\
    v(t)         & = \frac{L}{s(t)}\frac{di(t)}{dt} + R i(t)
\end{align*}

Taking \( x_1 = i, \ x_2 = s, \ x_3 = \dot s \), we can rewrite the above equations as
\begin{align*}
    \dot x_1(t) & = \frac{v(t) - R x_1(t)}{L} x_2(t)          \\
    \dot x_2(t) & = x_3(t)                                    \\
    \dot x_3(t) & = \frac{K}{M} \frac{x_1^2(t)}{x_2^2(t)} - g
\end{align*}

\subsubsection*{(b) Equilibrium point(s) under input \(v(t)=V_{in}\)}

Under input \( v(t)=V_{in} \), the equilibrium points are obtained by setting the time derivatives of the state variables to zero, i.e., \( \dot x_1(t) = 0, \ \dot x_2(t) = 0, \ \dot x_3(t) = 0 \).
Thereby, we get
\begin{align*}
    \frac{Ki^2}{s^2} - Mg         & = 0      \\
    \frac{L}{s}\frac{di}{dt} + Ri & = V_{in}
\end{align*}
\begin{equation*}
    \implies
    \frac{i}{s} = \sqrt{\frac{Mg}{K}}
    \implies
    s = i \sqrt{\frac{K}{Mg}}
    \implies
    \frac{ds}{dt} = \sqrt{\frac{K}{Mg}} \frac{di}{dt} = \dot s(t) = 0
    \implies
    \frac{di}{dt} = 0
\end{equation*}
\begin{align*}
    \implies
    i = \frac{V_{in}}{R}
    \implies
    \boxed{
        s = \frac{V_{in}}{R} \sqrt{\frac{K}{Mg}}
    }
\end{align*}

\subsubsection*{(c) Linearized system around all the equilibrium points}

Given a non-linear system of the form \( \dot x(t) = f(t, x) \), we can linearise it around the equilibrium point \( \phi \) as follows:
\[
    \dot x(t) = f(t, x) = f(\phi) + \left. \frac{\partial f}{\partial x} \right|_{\phi} (x - \phi)
\]
