\section*{Problem 2}

Convert the following \(n\)-th order linear differential equation (\( y^{(j)} \) denotes the \(j\)-th derivative)
\[
    y^{(n)}(t) + a_{n-1}(t) y^{(n-1)}(t) + a_{n-2}(t) y^{(n-2)}(t) + \cdots + a_{1}(t) y^{(1)}(t) + a_{0}(t) y(t) = b_0(t) u(t) + b_1(t) u^{(1)}(t)
\]
into the following type of equation:
\begin{align*}
    \dot{x}(t) & = A(t) x(t) + B(t) u(t) \\
    y(t)       & = C(t) x(t) + D(t) u(t)
\end{align*}

\textit{Hint:} Let, \( x^{(n)}(t) = y^{(n-1)}(t) - b_1(t)u(t) \)

\subsection*{Solution}

We will omit the \((t)\) notation part.
Assume function of \(t\) wherever necessary.

Given the differential equation,
\[
    y^{(n)} + a_{n-1} y^{(n-1)} + a_{n-2} y^{(n-2)} + \cdots + a_1 y^{(1)} + a_0 y = b_0 u + b_1 u^{(1)}
\]

Using the following substitutions, we have
\begin{align*}
    x_1     & = y                 \\
    x_2     & = y^{(1)}           \\
    x_3     & = y^{(2)}           \\
            & \vdots              \\
    x_{n-1} & = y^{(n-2)}         \\
    x_n     & = y^{(n-1)} - b_1 u
\end{align*}

Thus, we have
\begin{align*}
    \dot x_1
     & =
    x_2
    \\
    \dot x_2
     & =
    x_3
    \\
    \dot x_3
     & =
    x_4
    \\
     &
    \vdots
    \\
    \dot x_{n-2}
     & =
    x_{n-1}
    \\
    \dot x_{n-1}
     & =
    x_n + b_1 u
    \\
    \dot x_n
     & =
    y^{(n)} - b_1 u^{(1)} - b_1^{(1)} u
    \\
     & =
    b_0 u + \cancel{b_1 u^{(1)}} - a_{n-1} y^{(n-1)} - a_{n-2} y^{(n-2)} - \cdots - a_1 y^{(1)} - a_0 y - \cancel{b_1 u^{(1)}} - b_1^{(1)} u
    \\
     & =
    b_0 u - a_{n-1} (x_n + b_1 u) - a_{n-2} x_{n-1} - \cdots - a_1 x_2 - a_0 x_1 - b_1^{(1)} u
\end{align*}

Thus, we have
\[
    \begin{aligned}
        \dot{x}(t) & = A(t) x(t) + B(t) u(t) \\
        y(t)       & = C(t) x(t) + D(t) u(t)
    \end{aligned}
\]

where
\[
    x(t) =
    \begin{bmatrix}
        x_1     \\
        x_2     \\
        \vdots  \\
        x_{n-1} \\
        x_n
    \end{bmatrix}
    _{n \times 1}
\]
\[
    u(t) =
    \begin{bmatrix}
        u
    \end{bmatrix}
    _{1 \times 1}
\]
\[
    A(t) =
    \begin{bmatrix}
        0      & 1      & 0      & \cdots & 0        \\
        0      & 0      & 1      & \cdots & 0        \\
        \vdots & \vdots & \vdots & \ddots & \vdots   \\
        0      & 0      & 0      & \cdots & 1        \\
        -a_0   & -a_1   & -a_2   & \cdots & -a_{n-1}
    \end{bmatrix}
    _{n \times n}
\]
\[
    B(t) =
    \begin{bmatrix}
        0                            \\
        0                            \\
        \vdots                       \\
        0                            \\
        b_1                          \\
        b_0 - a_{n-1}b_1 - b_1^{(1)} \\
    \end{bmatrix}
    _{n \times 1}
\]
\[
    C(t) =
    \begin{bmatrix}
        1 & 0 & 0 & \cdots & 0
    \end{bmatrix}
    _{1 \times n}
\]
\[
    D(t) =
    \begin{bmatrix}
        0
    \end{bmatrix}
    _{1 \times 1}
\]

Therefore,
\[
    \boxed{
        \dot{x}(t)
        =
        \begin{bmatrix}
            0       & 1       & 0       & \cdots & 0           \\
            0       & 0       & 1       & \cdots & 0           \\
            \vdots  & \vdots  & \vdots  & \ddots & \vdots      \\
            0       & 0       & 0       & \cdots & 1           \\
            -a_0(t) & -a_1(t) & -a_2(t) & \cdots & -a_{n-1}(t)
        \end{bmatrix}
        \begin{bmatrix}
            x_1(t)     \\
            x_2(t)     \\
            \vdots     \\
            x_{n-1}(t) \\
            x_n(t)
        \end{bmatrix}
        +
        \begin{bmatrix}
            0      \\
            0      \\
            \vdots \\
            0      \\
            b_1(t) \\
            b_0(t) - a_{n-1}(t)b_1(t) - b_1^{(1)}(t)
        \end{bmatrix}
        u(t)
    }
\]
\[
    \boxed{
        y(t)
        =
        \begin{bmatrix}
            1 & 0 & 0 & \cdots & 0
        \end{bmatrix}
        \begin{bmatrix}
            x_1(t) \\
            x_2(t) \\
            x_3(t) \\
            \vdots \\
            x_n(t)
        \end{bmatrix}
        +
        \begin{bmatrix}
            0
        \end{bmatrix}
        u(t)
    }
\]
